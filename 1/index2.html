<!DOCTYPE html>
<html>
    <style>
        table, th, td {
          border:1px solid black;
          text-align: left;
        }
        th,td {
          padding: 5px;
        }
        table{
          margin:auto;
        }
        th > div, td > div{
            display: block;
        }
        th{
            background: rgb(255, 255, 255);
        }
        .hiddenCell{
            visibility: hidden;
            max-width: 10px;
        }
        
    </style>
<body>



<table style="margin-top: 200px;">
  <tr>
      <th colspan="2" name="A-B"><button  onclick="toggle(event)">-</button><div>A-B</div> </th>
      <th colspan="3" name="C-D-E"><button  onclick="toggle(event)">-</button><div>C-D-E</div></th>
    </tr>
<tr>
  <th name="A"><button  onclick="toggle(event)">-</button><div>Aaaaaaaaaaa</div></th>
  <th name="B"><button  onclick="toggle(event)">-</button><div>Bbbbbbbbbbb</div></th>
  <th name="C"><button  onclick="toggle(event)">-</button><div>Cccccccccc</div></th>
  <th name="D"><button  onclick="toggle(event)">-</button><div>Dddddddd</div></th>
  <th name="E"><button  onclick="toggle(event)">-</button><div>Eeeeee</div></th>
</tr>
<tr>
  <td name="A_"><div >A</div></td>
  <td name="B_"><div >Bbbbbbbbbbbbbbbb</div></td>
  <td name="C_"><div >Ccccccccccccc</div></td>
  <td name="D_"><div >D</div></td>
  <td name="E_"><div >Eddddddddd</div></td>
</tr>
<tr>
  <td name="A_"><div >A</div></td>
  <td name="B_"><div >Bbbbb</div></td>
  <td name="C_"><div >eeeefffffffC</div></td>
  <td name="D_"><div >D</div></td>
  <td name="E_"><div >Ebeeeeeeeee</div></td>
</tr>
</table>

<script>

    function ToggleTransparent(id, isClosed) {
        let elements = document.getElementsByName(id+"_");
        let Header = document.getElementsByName(id)[0];
        ToggleTransparentCell(Header, isClosed);
        for (var i = 0; i < elements.length; i++) {
            ToggleTransparentCell(elements[i], isClosed);
        }
    }
    function ToggleColumn(id, isClosed) {
        let elements = document.getElementsByName(id+"_");
        let Header = document.getElementsByName(id)[0];
        ToggleCellDisplay(Header, isClosed);
        console.log(elements.length);
        for (var i = 0; i < elements.length; i++) {
            ToggleCellDisplay(elements[i], isClosed);
        }
    }

    function ToggleTransparentCell(element, isClosed) {
        if( isClosed ){
            element.classList.remove("hiddenCell");
        }else{
            element.classList.add("hiddenCell");
        }
    }

    function ToggleHeader(element, isClosed) {
        var childs = element.children;
        if(childs == null) return;
        for (var i = 0; i < childs.length; i++) {
          var child = childs[i];
          if(child.tagName != "BUTTON"){
            child.style.display = isClosed == true ? "" : "none";
          }
        }
    }

    function ToggleCellDisplay(element, isClosed) {
        element.style.display = isClosed == true ? "" : "none";
    }

    function toggle(e) {
        let isClosed = e.target.innerHTML == "+" ? true : false;
        e.target.innerHTML = isClosed ? "-" : "+";
        let header = e.target.parentElement;
        let parentName = header.getAttribute("name");
        var colSpan = header.getAttribute("colspan");
        var colscount = 0;
        let i = 1;
        let cols = parentName.split("-");
        if(cols.length == 1){
            ToggleHeader(header, isClosed);
            let elements = document.getElementsByName(cols[0]+"_");
            for (let i = 0; i < elements.length; i++) {
                ToggleTransparentCell(elements[i], isClosed);
            }
        }else{
            ToggleTransparent(cols[0], isClosed);
            for(let i=1; i<cols.length; i++){
                ToggleColumn(cols[i], isClosed);
            }
            header.colSpan =  header.colSpan == cols.length ? 1 : cols.length;
        }
        
    }


    
</script>

</body>
</html>

